<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - FAA.ZONE‚Ñ¢</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Base styles for the entire combined page, derived from the dark version */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); /* Deep space gradient */
            color: #E0E0E0; /* Light gray for general text */
            min-height: 100vh;
            display: flex;
            flex-direction: column; /* Allows header, main, footer stacking */
            align-items: center;
            padding: 0; /* Reset default body padding */
            margin: 0; /* Reset default body margin */
        }

        /* Sticky header at the top, derived from dark version's header */
        header {
            position: sticky;
            top: 0;
            width: 100%;
            background-color: rgba(30, 30, 45, 0.9); /* Slightly transparent dark header */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); /* Deeper shadow */
            backdrop-filter: blur(5px); /* Subtle blur effect */
            border-bottom: 1px solid rgba(70, 70, 90, 0.5); /* Subtle bottom border */
            z-index: 1000;
            padding: 1.5rem 2.5rem; /* Consistent padding */
        }
        header a {
            transition: all 0.3s ease-in-out;
            color: #C0C0C0; /* Lighter gray for links */
            padding: 0.6rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
        }
        header a:hover {
            background-color: rgba(60, 60, 90, 0.7); /* Darker hover background */
            color: #93C5FD; /* Light blue accent on hover */
            transform: translateY(-2px); /* Subtle lift effect */
        }
        /* Specific styling for the gorilla logo within the header - preserving original size */
        header .logo-group {
            display: flex;
            align-items: center;
            gap: 0.5rem; /* Space between gorilla and text */
        }
        header .logo-gorilla {
            font-size: 2.5rem; /* Equivalent to text-4xl from original */
            line-height: 1; /* Adjust line height for better alignment */
        }
        header .logo-text {
            font-size: 1.875rem; /* Equivalent to text-3xl from original */
            font-weight: 700; /* Equivalent to font-bold from original */
            color: #A78BFA; /* Purple accent for logo text in dark theme */
        }

        /* Main content area to push footer down */
        .main-content-area {
            flex-grow: 1; /* Allows this section to take up available space */
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4rem 1rem; /* Padding around the main cards */
            box-sizing: border-box;
        }

        /* Common styles for both main content cards */
        .main-container-card {
            border-radius: 1.5rem; /* More rounded */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); /* Deeper shadow */
            max-width: 80rem; /* Increased max-width */
            width: 100%;
            text-align: center;
            padding: 2.5rem; /* Consistent padding */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: auto; /* Removed fixed min-height to reduce block size */
            box-sizing: border-box;
        }

        /* Specific styles for the light theme pricing section */
        .light-theme-section {
            background-color: #ffffff; /* White background for light theme */
            border-top: 8px solid #4f46e5; /* border-t-8 border-indigo-600 */
            color: #2d3748; /* Dark text for light theme */
        }
        .light-theme-section h2, .light-theme-section p {
            color: #2d3748; /* Darker text for headings/paragraphs */
        }
        .light-theme-section .text-indigo-600 {
            color: #4f46e5;
        }
        .light-theme-section .text-slate-700 {
            color: #334155;
        }
        .light-theme-section .currency-selector-container {
            background-color: #f8fafc; /* slate-50 */
            border: 1px solid #e2e8f0; /* slate-200 */
            color: #334155; /* slate-700 */
            max-width: 20rem; /* Adjusted for compactness */
            padding: 1rem; /* Adjusted padding */
            margin: 2rem auto; /* Adjusted margin */
        }
        .light-theme-section .currency-selector-container select {
            background-color: #ffffff; /* bg-white */
            border: 1px solid #cbd5e1; /* slate-300 */
            color: #1e293b; /* slate-800 */
        }
        .light-theme-section .product-card {
            background-color: #f8fafc; /* slate-50 */
            border: 1px solid #e2e8f0; /* slate-200 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-md */
            color: #334155; /* slate-700 for lists */
        }
        .light-theme-section .product-card h3 {
            color: #1e293b; /* slate-800 */
        }
        .light-theme-section .product-card p {
            color: #475569; /* slate-600 */
        }
        .light-theme-section .product-card .price-display {
            color: #4f46e5; /* indigo-600 */
        }
        .light-theme-section .product-card .price-display span {
            color: #64748b; /* slate-500 */
        }
        /* Reverted button color for light theme to original blue */
        .light-theme-section .buy-now-button { /* More specific selector */
            background-color: #4f46e5 !important; /* indigo-600, added !important for strictness */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-lg */
        }
        .light-theme-section .buy-now-button:hover {
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.4);
        }

        /* Specific styles for the dark theme pricing section */
        .dark-theme-section {
            background-color: rgba(25, 25, 40, 0.9);
            border: 1px solid rgba(70, 70, 90, 0.5);
            color: #E0E0E0; /* Light gray for general text */
            margin-top: 4rem; /* Space between the two sections */
        }
        .dark-theme-section h2, .dark-theme-section p {
            color: #E0E0E0; /* Light gray for headings/paragraphs */
        }
        .dark-theme-section .text-blue-400 {
            color: #60A5FA;
        }
        .dark-theme-section .text-purple-400 {
            color: #A78BFA;
        }
        .dark-theme-section .currency-selector-container {
            background-color: rgba(45, 45, 70, 0.8);
            border: 1px solid rgba(80, 80, 100, 0.6);
            color: #D0D0D0;
            max-width: 20rem; /* Adjusted for compactness */
            padding: 1rem; /* Adjusted padding */
            margin: 2rem auto; /* Adjusted margin */
        }
        .dark-theme-section .currency-selector-container select {
            background-color: rgba(60, 60, 90, 0.9);
            border: 1px solid rgba(100, 100, 120, 0.7);
            color: #E0E0E0;
        }
        .dark-theme-section .product-card {
            background-color: rgba(25, 25, 40, 0.9);
            border: 1px solid rgba(70, 70, 90, 0.5);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            color: #C0C0C0; /* Light gray for lists */
        }
        .dark-theme-section .product-card:hover {
            border-color: #A78BFA;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
        }
        .dark-theme-section .product-card h3 {
            color: #A78BFA; /* Purple for card titles */
        }
        .dark-theme-section .product-card p {
            color: #B0B0B0; /* Lighter gray for descriptive text */
        }
        .dark-theme-section .product-card .price-display {
            color: #93C5FD; /* Light blue for prices */
        }
        .dark-theme-section .product-card .price-display span {
            color: #A0A0A0; /* Slightly darker light gray for "/ month" */
        }
        .dark-theme-section .cta-button {
            background: linear-gradient(45deg, #6B46C1, #8B5CF6); /* Purple gradient */
            box-shadow: 0 6px 15px rgba(139, 92, 246, 0.4);
        }
        .dark-theme-section .cta-button:hover {
            background: linear-gradient(45deg, #7C5BC7, #9B6EF9);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.6);
        }

        /* Common product card and button styles */
        .product-card {
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: left;
            display: flex;
            flex-direction: column; /* Changed to column to stack elements */
            justify-content: space-between; /* Distributes space, pushing last item (button) to bottom */
            height: auto; /* Allow height to adjust based on content */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Smooth transition for hover */
        }
        /* New wrapper for top content inside product card */
        .product-card-top-content {
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* Ensures this content section takes available space */
        }
        .product-card-top-content ul {
            flex-grow: 1; /* Ensures feature list grows, pushing price down */
        }
        .product-card h3 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 700; /* font-bold */
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .product-card p {
            margin-bottom: 1rem; /* mb-4 */
        }
        .product-card ul {
            list-style: disc;
            list-style-position: inside;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.5; /* space-y-1 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        .price-display {
            font-size: 2.25rem; /* text-3xl */
            font-weight: 800; /* font-extrabold */
            margin-top: auto; /* Pushes the price to the bottom of the card content area */
            margin-bottom: 1.5rem; /* mb-6 from original */
        }
        .price-display span {
            font-size: 1rem; /* text-base */
            font-weight: 400; /* font-normal */
        }
        .buy-now-button {
            font-weight: 600; /* font-semibold */
            padding: 0.75rem 1.5rem; /* py-3 px-6 */
            border-radius: 0.75rem; /* rounded-xl */
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: none;
            width: 100%; /* w-full */
        }
        .buy-now-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            transition: all 0.7s ease-out;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
        }
        .buy-now-button:hover::before {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        /* Hover effects for product cards */
        /* Common bounce animation for all cards on hover */
        .product-card:hover {
            animation: bounce 0.6s ease-in-out;
            transform: translateY(-5px); /* Ensure a slight lift with bounce */
        }

        /* Specific text color changes on hover based on theme */
        .light-theme-section .product-card:hover h3,
        .light-theme-section .product-card:hover p,
        .light-theme-section .product-card:hover ul li,
        .light-theme-section .product-card:hover .price-display,
        .light-theme-section .product-card:hover .price-display span {
            /* Keep original dark text color for light theme cards on hover */
            color: inherit !important; /* Explicitly inherit to prevent white text */
            /* Or define specific dark colors if 'inherit' doesn't work as expected for all elements */
            /* Example: color: #2d3748 !important; */
        }

        .dark-theme-section .product-card:hover h3,
        .dark-theme-section .product-card:hover p,
        .dark-theme-section .product-card:hover ul li,
        .dark-theme-section .product-card:hover .price-display,
        .dark-theme-section .product-card:hover .price-display span {
            color: #FFFFFF !important; /* White text on hover for dark theme cards */
            transition: color 0.3s ease;
        }


        /* Bounce animation keyframes */
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px); /* Slight upward bounce */
            }
        }


        /* PayPal Error/Success Message Display */
        .paypal-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 0.9rem;
            max-width: 300px;
            text-align: center;
            animation: fadeInOut 5s forwards;
        }
        .paypal-error-message {
            background-color: #ffdddd;
            color: #d8000c;
        }
        .paypal-success-message {
            background-color: #d4edda;
            color: #155724;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }

        /* Footer (from dark version, applied universally) */
        footer {
            background-color: rgba(20, 20, 35, 0.9);
            border-top: 1px solid rgba(70, 70, 90, 0.5);
            color: #A0A0A0; /* Slightly darker gray for footer text */
            padding: 2rem;
            margin-top: auto; /* Pushes footer to the bottom */
            width: 100%; /* Ensure footer spans full width */
        }
        footer .page-footer-logo {
            color: #A78BFA;
            font-weight: 800;
        }
        footer a {
            color: #C0C0C0;
            transition: color 0.3s ease;
        }
        footer a:hover {
            color: #93C5FD;
        }
    </style>
</head>
<body>
    <!-- Header (from dark version, applied universally) -->
    <header class="w-full">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0">
            <div class="logo-group">
                <span class="logo-gorilla">ü¶ç</span>
                <h1 class="logo-text">FAA.ZONE&trade;</h1>
            </div>
            <nav class="flex flex-wrap justify-center md:justify-end items-center space-x-4 md:space-x-6 text-sm">
                <a href="/">Home</a>
                <a href="/pricing">Pricing & Plans üí∞</a>
                <a href="/products">Products</a>
                <a href="/about">About Us ‚ÑπÔ∏è</a>
                <a href="/contact">Contact Us üìß</a>
            </nav>
        </div>
    </header>

    <div class="main-content-area">
        <!-- Light Version Pricing Section (acting as "master template expanding") -->
        <div class="main-container-card light-theme-section">
            <div>
                <h2 class="text-4xl font-extrabold mb-4 tracking-tight">
                    Explore Our <span class="text-indigo-600">Products</span>
                </h2>
                <p class="text-lg text-slate-700 mb-8 leading-relaxed">
                    Choose the package that best fits your needs and proceed to a secure checkout.
                </p>

                <!-- Currency Selector for Light Version -->
                <div class="currency-selector-container mx-auto text-left flex items-center justify-between">
                    <label for="currency-select-light" class="font-medium">Display prices in:</label>
                    <select id="currency-select-light" class="ml-4 p-2 border rounded-md text-sm">
                        <option value="ZAR">ZAR (R)</option>
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (‚Ç¨)</option>
                        <option value="GBP">GBP (¬£)</option>
                    </select>
                </div>

                <!-- Product Cards for Light Version -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                    <!-- Product 1: Starter Package (Light) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Starter Package</h3>
                            <p class="mb-4">Ideal for individuals and small teams beginning their digital journey.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>Basic API Access</li>
                                <li>Standard Analytics Dashboard</li>
                                <li>Community Support</li>
                                <li>Up to 5 Users</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="199.00" data-currency-symbol="R" data-currency-code="ZAR">R 199.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button featured-button"
                                data-product-name="Starter Package"
                                data-amount="199.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Starter Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>

                    <!-- Product 2: Business Package (Light) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Business Package</h3>
                            <p class="mb-4">Comprehensive tools for growing businesses and advanced operations.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>Advanced API Access</li>
                                <li>Premium Analytics & Reporting</li>
                                <li>Dedicated Priority Support</li>
                                <li>Unlimited Users</li>
                                <li>Custom Data Integrations</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="499.00" data-currency-symbol="R" data-currency-code="ZAR">R 499.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button featured-button"
                                data-product-name="Business Package"
                                data-amount="499.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Business Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>

                    <!-- Product 3: Enterprise Package (Light) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Enterprise Package</h3>
                            <p class="mb-4">Full-scale solutions for large organizations and custom needs.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>All Business Package Features</li>
                                <li>Dedicated Account Manager</li>
                                <li>24/7 Phone Support</li>
                                <li>Enhanced Custom Integrations</li>
                                <li>On-site Training & Setup</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="1200.00" data-currency-symbol="R" data-currency-code="ZAR">R 1200.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button featured-button"
                                data-product-name="Enterprise Package"
                                data-amount="1200.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Enterprise Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dark Version Pricing Section (following the light version) -->
        <div class="main-container-card dark-theme-section">
            <div>
                <h2 class="text-4xl font-extrabold mb-4 tracking-tight">
                    Explore Our <span class="text-purple-400">Products</span>
                </h2>
                <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                    Choose the package that best fits your needs and proceed to a secure checkout.
                </p>

                <!-- Currency Selector for Dark Version -->
                <div class="currency-selector-container mx-auto text-left flex items-center justify-between">
                    <label for="currency-select-dark" class="font-medium">Display prices in:</label>
                    <select id="currency-select-dark" class="ml-4 p-2 border rounded-md text-sm">
                        <option value="ZAR">ZAR (R)</option>
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (‚Ç¨)</option>
                        <option value="GBP">GBP (¬£)</option>
                    </select>
                </div>

                <!-- Product Cards for Dark Version -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                    <!-- Product 1: Starter Package (Dark) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Starter Package</h3>
                            <p class="mb-4">Ideal for individuals and small teams beginning their digital journey.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>Basic API Access</li>
                                <li>Standard Analytics Dashboard</li>
                                <li>Community Support</li>
                                <li>Up to 5 Users</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="199.00" data-currency-symbol="R" data-currency-code="ZAR">R 199.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button cta-button w-full"
                                data-product-name="Starter Package"
                                data-amount="199.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Starter Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>

                    <!-- Product 2: Business Package (Dark) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Business Package</h3>
                            <p class="mb-4">Comprehensive tools for growing businesses and advanced operations.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>Advanced API Access</li>
                                <li>Premium Analytics & Reporting</li>
                                <li>Dedicated Priority Support</li>
                                <li>Unlimited Users</li>
                                <li>Custom Data Integrations</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="499.00" data-currency-symbol="R" data-currency-code="ZAR">R 499.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button cta-button w-full"
                                data-product-name="Business Package"
                                data-amount="499.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Business Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>

                    <!-- Product 3: Enterprise Package (Dark) -->
                    <div class="product-card">
                        <div class="product-card-top-content">
                            <h3 class="text-2xl font-bold mb-2">Enterprise Package</h3>
                            <p class="mb-4">Full-scale solutions for large organizations and custom needs.</p>
                            <ul class="list-disc list-inside space-y-1 mb-6">
                                <li>All Business Package Features</li>
                                <li>Dedicated Account Manager</li>
                                <li>24/7 Phone Support</li>
                                <li>Enhanced Custom Integrations</li>
                                <li>On-site Training & Setup</li>
                            </ul>
                        </div>
                        <p class="price-display" data-original-price="1200.00" data-currency-symbol="R" data-currency-code="ZAR">R 1200.00 <span class="text-base font-normal">/ month</span></p>
                        <button class="buy-now-button cta-button w-full"
                                data-product-name="Enterprise Package"
                                data-amount="1200.00"
                                data-billing-cycle="MONTHLY"
                                data-plan-key="Enterprise Package_MONTHLY">
                            Subscribe Now (Monthly)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer (from dark version, applied universally) -->
    <footer class="w-full">
        <div class="container mx-auto px-6">
            <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
                <div class="text-lg page-footer-logo">FAA.ZONE‚Ñ¢</div>
                <p class="text-sm">ScrollGrid ¬∑ PulseTrade Certified ¬∑ TreatyMesh Validated</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Privacy</a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Terms</a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Contact</a>
                </div>
            </div>
            <p class="text-xs mt-6 text-center">&copy; 2025 Fruitful Holdings (Pty) Ltd. All rights reserved.</p>
        </div>
    </footer>

    <!-- PayPal SDK Script -->
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_LIVE_CLIENT_ID&currency=ZAR&vault=true&intent=subscription"></script>

    <script type="module">
        // IMPORTANT: Replace this placeholder with your actual LIVE PayPal Client ID.
        const YOUR_PAYPAL_LIVE_CLIENT_ID = 'YOUR_PAYPAL_LIVE_CLIENT_ID'; // <--- !!! REPLACE THIS WITH YOUR LIVE CLIENT ID !!! --->

        // IMPORTANT: You MUST replace these placeholders with the actual LIVE PayPal Plan IDs
        // obtained after using the "Deploy Plan" button for these products in your admin portal,
        // after switching your backend to LIVE credentials.
        // The plan keys are 'Product Name_BILLING_CYCLE' (e.g., "Starter Package_MONTHLY").
        const PAYPAL_PLAN_IDS = {
            "Starter Package_MONTHLY": "P-YOUR_STARTER_MONTHLY_LIVE_PLAN_ID",   // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Starter Package_ANNUAL": "P-YOUR_STARTER_ANNUAL_LIVE_PLAN_ID",     // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_MONTHLY": "P-YOUR_BUSINESS_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_ANNUAL": "P-YOUR_BUSINESS_ANNUAL_LIVE_PLAN_ID",   // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_MONTHLY": "P-YOUR_ENTERPRISE_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_ANNUAL": "P-YOUR_ENTERPRISE_ANNUAL_LIVE_PLAN_ID"  // <--- !!! REPLACE THIS !!! --->
        };

        // Current logged-in user ID. Replace 'CURRENT_LOGGED_IN_USER_ID' with dynamic user ID from your auth system.
        const CURRENT_USER_ID = 'CURRENT_LOGGED_IN_USER_ID'; // <--- !!! REPLACE THIS !!! --->

        // Utility function to show temporary messages
        function showTemporaryMessage(message, type = 'error') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `paypal-message ${type === 'success' ? 'paypal-success-message' : 'paypal-error-message'}`;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            setTimeout(() => messageDiv.remove(), 5000); // Remove after 5 seconds
        }

        // Utility function to get currency symbol
        function getCurrencySymbol(currencyCode) {
            switch (currencyCode) {
                case 'USD': return '$';
                case 'EUR': return '‚Ç¨';
                case 'GBP': return '¬£';
                case 'ZAR': return 'R';
                default: return currencyCode;
            }
        }

        // Main logic once DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const API_KEY = "40015d117bc7fff9495dcf28"; // Your provided API key
            const BASE_CURRENCY = 'ZAR'; // Set to ZAR based on the updated data-original-price values
            let exchangeRates = {}; // Store fetched exchange rates globally for this script

            // Fetch exchange rates once for both currency converters
            async function fetchAllExchangeRates() {
                if (API_KEY === "") {
                    showTemporaryMessage('Currency converter API key is missing. Please set it up for currency conversion to work.', 'error');
                    // Disable all currency selectors if API key is missing
                    document.querySelectorAll('select[id^="currency-select"]').forEach(select => select.disabled = true);
                    console.warn("Currency converter: API_KEY is missing. Please get your API key from https://www.exchangerate-api.com/ and replace 'API_KEY' in the code. Currency conversion will not work without it.");
                    return;
                }

                try {
                    const response = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/latest/${BASE_CURRENCY}`);
                    if (!response.ok) {
                        const errorData = await response.json();
                        const errorMessage = `Could not fetch exchange rates: ${errorData['error-type'] || 'Unknown error.'}`;
                        showTemporaryMessage(errorMessage, 'error');
                        throw new Error(`HTTP error! Status: ${response.status}. API Error: ${errorData['error-type'] || 'Unknown error.'}`);
                    }
                    const data = await response.json();
                    if (data && data.conversion_rates) {
                        exchangeRates = data.conversion_rates;
                        console.log('Exchange rates fetched:', exchangeRates);
                        // Update prices for both sections after fetching rates
                        updatePricesForSection('light');
                        updatePricesForSection('dark');
                    } else {
                        showTemporaryMessage('Could not fetch exchange rates due to unexpected API response. Check console for details.', 'error');
                        console.error('Failed to fetch conversion rates: Unexpected API response structure.', data);
                        document.querySelectorAll('select[id^="currency-select"]').forEach(select => select.disabled = true);
                    }
                } catch (error) {
                    showTemporaryMessage(`Error fetching exchange rates: ${error.message}. Please check your API key, network connection, and API usage limits.`, 'error');
                    console.error('Error fetching exchange rates:', error.message || error);
                    document.querySelectorAll('select[id^="currency-select"]').forEach(select => select.disabled = true);
                }
            }

            // Function to update prices for a specific section (light or dark)
            function updatePricesForSection(theme) {
                const currencySelectId = `currency-select-${theme}`;
                const currencySelect = document.getElementById(currencySelectId);
                const priceDisplays = document.querySelectorAll(`.${theme}-theme-section .price-display`);

                if (!currencySelect) return; // Exit if the select element for this theme isn't found

                const selectedCurrency = currencySelect.value;
                const selectedSymbol = getCurrencySymbol(selectedCurrency);

                priceDisplays.forEach(priceSpan => {
                    const originalPriceValue = parseFloat(priceSpan.dataset.originalPrice);
                    let convertedPrice = originalPriceValue;

                    if (selectedCurrency !== BASE_CURRENCY && exchangeRates[selectedCurrency]) {
                        convertedPrice = originalPriceValue * exchangeRates[selectedCurrency];
                    }
                    // Determine the text color for the price suffix based on the theme
                    const suffixTextColorClass = theme === 'light' ? 'text-slate-500' : 'text-gray-400';
                    priceSpan.innerHTML = `${selectedSymbol}${convertedPrice.toFixed(2)} <span class="${suffixTextColorClass} text-base font-normal">/ month</span>`;
                    priceSpan.dataset.currencyCode = selectedCurrency;
                });
            }

            // Add event listeners for both currency selectors
            const currencySelectLight = document.getElementById('currency-select-light');
            const currencySelectDark = document.getElementById('currency-select-dark');

            if (currencySelectLight) {
                currencySelectLight.addEventListener('change', () => updatePricesForSection('light'));
            }
            if (currencySelectDark) {
                currencySelectDark.addEventListener('change', () => updatePricesForSection('dark'));
            }

            // Fetch rates on page load for both sections
            fetchAllExchangeRates();

            // --- PayPal Subscription Initiation ---
            async function initiatePayPalSubscription(event) {
                const button = event.currentTarget;
                button.disabled = true;
                const originalButtonText = button.textContent;
                button.textContent = 'Processing...';

                const productName = button.dataset.productName;
                const billingCycle = button.dataset.billingCycle;
                const planKey = button.dataset.planKey;
                const planId = PAYPAL_PLAN_IDS[planKey];

                // Determine which currency selector was active for this product's section
                const parentSection = button.closest('.main-container-card');
                let selectedCurrency = BASE_CURRENCY; // Default to base currency
                if (parentSection.classList.contains('light-theme-section')) {
                    selectedCurrency = document.getElementById('currency-select-light').value;
                } else if (parentSection.classList.contains('dark-theme-section')) {
                    selectedCurrency = document.getElementById('currency-select-dark').value;
                }


                if (!planId || planId.includes('YOUR_')) {
                    showTemporaryMessage(`Subscription plan ID not configured for ${productName} (${billingCycle}). Please update PAYPAL_PLAN_IDS in the script with LIVE Plan IDs.`, 'error');
                    console.error(`Missing or placeholder PayPal Plan ID for ${planKey}`);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                    return;
                }

                try {
                    const response = await fetch(`/api/paypal?action=create-subscription`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            planId: planId,
                            userId: CURRENT_USER_ID,
                            productName: productName,
                            billingCycle: billingCycle,
                            currencyCode: selectedCurrency,
                            amount: parseFloat(button.dataset.amount)
                        }),
                    });

                    const result = await response.json();

                    if (!response.ok) {
                        showTemporaryMessage(`Failed to create subscription: ${result.error || 'Unknown error'}. Check console.`, 'error');
                        console.error('Backend create-subscription error:', result);
                        throw new Error(result.error || 'Failed to create PayPal subscription on backend');
                    }

                    if (result.approveUrl) {
                        window.location.href = result.approveUrl;
                    } else {
                        showTemporaryMessage('No approval URL received from PayPal.', 'error');
                        throw new Error('No approval URL received from PayPal.');
                    }

                } catch (error) {
                    showTemporaryMessage(`An error occurred: ${error.message}. Please try again.`, 'error');
                    console.error('Error initiating PayPal subscription:', error);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                }
            }

            // Attach click event listeners to all "buy-now-button" elements
            document.querySelectorAll('.buy-now-button').forEach(button => {
                button.addEventListener('click', initiatePayPalSubscription);
            });
        });
    </script>
</body>
</html>